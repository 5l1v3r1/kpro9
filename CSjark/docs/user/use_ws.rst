Using the generated Lua files in Wireshark
==========================================

These are the steps needed to use a Lua dissector generated by CSjark with Wireshark.

1. Get the latest version of Wireshark as described in the installation section :ref:`ws`.
2. Locate the Personal configuration and the Personal Plugins directories. To do this, start Wireshark and click on ``Help`` in the menubar and then on ``About Wireshark``. This should bring up the About Wireshark dialog. From there, navigate to the ``Folders`` tab. Locate folders ``Personal configuration`` and ``Personal Plugins`` and note their paths (see below). 

.. image:: /img/ws_about_folders.png
    :alt: About Wireshark - Folders
    :align: center
    
..
    
    - on Linux/Unix system it may be  ``~/.wireshark/`` and  ``~/.wireshark/plugins/`` 
    - on Windows it may be ``C:\Users\*YourUserName*\AppData\Roaming\Wireshark\`` 
        and ``C:\Users\*YourUserName*\AppData\Roaming\Wireshark\plugins\`` 
    
    If the folders does not exist, create them.

3. Copy CSjark generated file ``luastructs.lua`` into the ``Personal configuration`` folder located in step 1.
4. Copy CSjark generated Lua dissectors into the ``Personal Plugins`` folder located in step 1.
5. Open the ``init.lua`` in the ``Personal configuration`` folder located in step 1. Insert the following code: ::

        dofile("luastructs.lua")

..

    This ensures that the ``luastructs.lua`` is loaded before the Lua scripts in the ``Personal Plugins`` folder.

6. Restart Wireshark.


To check that the scripts are loaded, click on the ``Help`` button in the menubar and choose ``About``. Navigate to the ``Plugins`` tab. The scripts should now appear in the list.

.. image:: /img/ws_about_plugins.png
    :alt: About Wireshark - Plugins
    :align: center

To add further dissectors, only step 2, 5 and 6 needs to be repeated.

For further information on the Lua integration in Wireshark, please visit:
`Lua Support in Wireshark <http://www.wireshark.org/docs/wsug_html_chunked/wsluarm.html>`_.