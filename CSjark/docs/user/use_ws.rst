..
    Copyright (C) 2011 Even Wiik Thomassen, Erik Bergersen,
    Sondre Johan Mannsverk, Terje Snarby, Lars Solvoll TÃ¸nder,
    Sigurd Wien and Jaroslav Fibichr.
    
    This file is part of CSjark.
    
    CSjark is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.
    
    CSjark is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.
    
    You should have received a copy of the GNU General Public License
    along with CSjark.  If not, see <http://www.gnu.org/licenses/>.


Using the generated Lua files in Wireshark
==========================================

These are the steps needed to use a Lua dissector generated by CSjark with Wireshark.

1. Get the latest version of Wireshark as described in the installation section :ref:`ws`.
2. Locate the Personal configuration and the Personal Plugins directories. To do this, start Wireshark and click on ``Help`` in the menubar and then on ``About Wireshark``. This should bring up the About Wireshark dialog. From there, navigate to the ``Folders`` tab. Locate folders ``Personal configuration`` and ``Personal Plugins`` and note their paths (see below). 

.. image:: /img/ws_about_folders.png
    :alt: About Wireshark - Folders
    :align: center
    
..
    
    - on Linux/Unix system it may be  ``~/.wireshark/`` and  ``~/.wireshark/plugins/`` 
    
    - on Windows it may be ``C:\Users\*YourUserName*\AppData\Roaming\Wireshark\`` 
        and ``C:\Users\*YourUserName*\AppData\Roaming\Wireshark\plugins\`` 
    
    If the folders does not exist, create them.

3. Copy CSjark generated file ``luastructs.lua`` into the ``Personal configuration`` folder located in step 2. 

.. note:
    Location of CSjark generated files is given by ``-o`` argument. More in section :ref:`use`.
    
4. Copy CSjark generated Lua dissectors into the ``Personal Plugins`` folder located in step 2.
5. Open the file ``init.lua`` located in the ``Personal configuration`` folder which you found in step 2. Insert the following code: ::

        dofile("luastructs.lua")

..

    This ensures that the ``luastructs.lua`` is loaded before all other Lua scripts. ``luastructs.lua`` is a protocol that maps the id of the messages to the correct dissector, and calls them.

6. Restart Wireshark.
    To check that the scripts are loaded, navigate to ``Help`` -> ``About`` -> ``Plugins``. The scripts should now appear in the list as "lua script".

.. image:: /img/ws_about_plugins.png
    :alt: About Wireshark - Plugins
    :align: center


To add further dissectors, only step 4, 5 and 6 needs to be repeated.

For further information on the Lua integration in Wireshark, please visit:
`Lua Support in Wireshark <http://www.wireshark.org/docs/wsug_html_chunked/wsluarm.html>`_.
